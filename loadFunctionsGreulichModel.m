%% Load functions for fits of the dosage-response curves

% Solutions of the cubic equation derived in 
% Mol Syst Biol 2015 Mar;11(3):796. doi: 10.15252/msb.20145949.


%% 3  parameters fits..
% syms a b c x y
% 
% eqn =  (c*y)^3 - (c*y)^2 + (c*y)*((c*a)^2 + a*b*c*x) - (c*a)^2 == 0;
% [soly] = solve(eqn, y, 'MaxDegree', 3)

% Relation with the dosage-response parameters:
% a = Lambda*/2
% b = 1/d*
% c = 1/Lambda0

 g1 = @(a, b, c, x) (((1/(27*c^3) - (c*a^2 + b*x*a)/(6*c^2) + a^2/(2*c))^2 + ((c*a^2 + b*x*a)/(3*c) - 1/(9*c^2))^3)^(1/2) - (c*a^2 + b*x*a)/(6*c^2) + 1/(27*c^3) + a^2/(2*c))^(1/3) - ((c*a^2 + b*x*a)/(3*c) - 1/(9*c^2))/(((1/(27*c^3) - (c*a^2 + b*x*a)/(6*c^2) + a^2/(2*c))^2 + ((c*a^2 + b*x*a)/(3*c) - 1/(9*c^2))^3)^(1/2) - (c*a^2 + b*x*a)/(6*c^2) + 1/(27*c^3) + a^2/(2*c))^(1/3) + 1/(3*c);
 g2 = @(a, b, c, x) ((c*a^2 + b*x*a)/(3*c) - 1/(9*c^2))/(2*(((1/(27*c^3) - (c*a^2 + b*x*a)/(6*c^2) + a^2/(2*c))^2 + ((c*a^2 + b*x*a)/(3*c) - 1/(9*c^2))^3)^(1/2) - (c*a^2 + b*x*a)/(6*c^2) + 1/(27*c^3) + a^2/(2*c))^(1/3)) - (((1/(27*c^3) - (c*a^2 + b*x*a)/(6*c^2) + a^2/(2*c))^2 + ((c*a^2 + b*x*a)/(3*c) - 1/(9*c^2))^3)^(1/2) - (c*a^2 + b*x*a)/(6*c^2) + 1/(27*c^3) + a^2/(2*c))^(1/3)/2 - (3^(1/2)*((((1/(27*c^3) - (c*a^2 + b*x*a)/(6*c^2) + a^2/(2*c))^2 + ((c*a^2 + b*x*a)/(3*c) - 1/(9*c^2))^3)^(1/2) - (c*a^2 + b*x*a)/(6*c^2) + 1/(27*c^3) + a^2/(2*c))^(1/3) + ((c*a^2 + b*x*a)/(3*c) - 1/(9*c^2))/(((1/(27*c^3) - (c*a^2 + b*x*a)/(6*c^2) + a^2/(2*c))^2 + ((c*a^2 + b*x*a)/(3*c) - 1/(9*c^2))^3)^(1/2) - (c*a^2 + b*x*a)/(6*c^2) + 1/(27*c^3) + a^2/(2*c))^(1/3))*1i)/2 + 1/(3*c);
 g3 = @(a, b, c, x) ((c*a^2 + b*x*a)/(3*c) - 1/(9*c^2))/(2*(((1/(27*c^3) - (c*a^2 + b*x*a)/(6*c^2) + a^2/(2*c))^2 + ((c*a^2 + b*x*a)/(3*c) - 1/(9*c^2))^3)^(1/2) - (c*a^2 + b*x*a)/(6*c^2) + 1/(27*c^3) + a^2/(2*c))^(1/3)) - (((1/(27*c^3) - (c*a^2 + b*x*a)/(6*c^2) + a^2/(2*c))^2 + ((c*a^2 + b*x*a)/(3*c) - 1/(9*c^2))^3)^(1/2) - (c*a^2 + b*x*a)/(6*c^2) + 1/(27*c^3) + a^2/(2*c))^(1/3)/2 + (3^(1/2)*((((1/(27*c^3) - (c*a^2 + b*x*a)/(6*c^2) + a^2/(2*c))^2 + ((c*a^2 + b*x*a)/(3*c) - 1/(9*c^2))^3)^(1/2) - (c*a^2 + b*x*a)/(6*c^2) + 1/(27*c^3) + a^2/(2*c))^(1/3) + ((c*a^2 + b*x*a)/(3*c) - 1/(9*c^2))/(((1/(27*c^3) - (c*a^2 + b*x*a)/(6*c^2) + a^2/(2*c))^2 + ((c*a^2 + b*x*a)/(3*c) - 1/(9*c^2))^3)^(1/2) - (c*a^2 + b*x*a)/(6*c^2) + 1/(27*c^3) + a^2/(2*c))^(1/3))*1i)/2 + 1/(3*c);
 














